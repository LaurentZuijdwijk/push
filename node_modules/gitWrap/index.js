var sys = require('sys'),
	exec = require('child_process').exec,
	color = require('colors'),
	async = require('async');

function fn(func){
	return function(){

	}
}

//wait till testing is done
// do a git status
// do a pull
// do a add .
// do a commit
// wait for message

async.series([
	//async.apply(exectest)},
	async.apply(execGit,"git status"),
	async.apply(execGit,"git add ."),
	async.apply(execGit,"git commit -m 'fe'"),
	async.apply(getRevision)
]);

function execTest(cb){
	exec('testacular run', puts)
}

function execGit(cmd, cb){
	console.log(cmd.green.bold.inverse)
	function puts(error, stdout, stderr) {
		if(error) cb(error, null)
		sys.puts(stdout) 
		cb(null, stdout);
	}
	exec(cmd, puts)	
}
function getRevision(cb){
	var cmd = 'git rev-list HEAD --count';

	exec(cmd, function(error, stdout, stderr){
		console.log('revision number'.green.inverse.bold + ' '.green.inverse.bold + stdout.green.inverse.bold);
		cb(null)
	})	

}
